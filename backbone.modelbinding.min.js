(function(a){var b=(function(k,l,h){var e={version:"0.5.0",bind:function(m,n){m.modelBinder=new d(m,n);
m.modelBinder.bind()
},unbind:function(m){if(m.modelBinder){m.modelBinder.unbind()
}}};
var d=function(m,n){this.config=new e.Configuration(n);
this.modelBindings=[];
this.elementBindings=[];
this.bind=function(){var o=e.Conventions;
for(var p in o){if(o.hasOwnProperty(p)){var s=o[p];
var r=s.handler;
var q=s.selector;
r.bind.call(this,q,m,m.model,this.config)
}}};
this.unbind=function(){l.each(this.elementBindings,function(o){o.element.unbind(o.eventName,o.callback)
});
l.each(this.modelBindings,function(o){o.model.unbind(o.eventName,o.callback)
})
};
this.registerModelBinding=function(p,q,r){var o="change:"+q;
p.bind(o,r);
this.modelBindings.push({model:p,eventName:o,callback:r})
};
this.registerDataBinding=function(p,o,q){p.bind(o,q);
this.modelBindings.push({model:p,eventName:o,callback:q})
};
this.registerElementBinding=function(o,p){o.bind("change",p);
this.elementBindings.push({element:o,eventName:"change",callback:p})
}
};
e.Configuration=function(n){this.bindingAttrConfig={};
l.extend(this.bindingAttrConfig,e.Configuration.bindindAttrConfig,n);
if(this.bindingAttrConfig.all){var m=this.bindingAttrConfig.all;
delete this.bindingAttrConfig.all;
for(var o in this.bindingAttrConfig){if(this.bindingAttrConfig.hasOwnProperty(o)){this.bindingAttrConfig[o]=m
}}}this.getBindingAttr=function(p){return this.bindingAttrConfig[p]
};
this.getBindingValue=function(q,r){var p=this.getBindingAttr(r);
return q.attr(p)
}
};
e.Configuration.bindindAttrConfig={text:"id",hidden:"id",textarea:"id",password:"id",radio:"name",checkbox:"id",select:"id",number:"id",range:"id",tel:"id",search:"id",url:"id",email:"id",date:"id",datetime:"id",datetime_local:"id",month:"id",time:"id",week:"id"};
e.Configuration.store=function(){e.Configuration.originalConfig=l.clone(e.Configuration.bindindAttrConfig)
};
e.Configuration.restore=function(){e.Configuration.bindindAttrConfig=e.Configuration.originalConfig
};
e.Configuration.configureBindingAttributes=function(m){if(m.all){this.configureAllBindingAttributes(m.all);
delete m.all
}l.extend(e.Configuration.bindindAttrConfig,m)
};
e.Configuration.configureAllBindingAttributes=function(n){var m=e.Configuration.bindindAttrConfig;
m.text=n;
m.hidden=n;
m.textarea=n;
m.password=n;
m.radio=n;
m.checkbox=n;
m.select=n;
m.number=n;
m.range=n;
m.tel=n;
m.search=n;
m.url=n;
m.email=n
};
var c=(function(o){var n={};
var m=function(p){var q=p[0].tagName.toLowerCase();
if(q=="input"){q=p.attr("type");
if(q==undefined||q==""){q="text"
}}return q
};
n.bind=function(p,r,t,s){var q=this;
r.$(p).each(function(A){var x=r.$(this);
var B=m(x);
var z=s.getBindingValue(x,B);
var C=function(D,E){x.val(E)
};
var v=function(F,E){var D={};
D[F]=E;
t.set(D)
};
var y=function(D){v(z,r.$(D.target).val())
};
q.registerModelBinding(t,z,C);
q.registerElementBinding(x,y);
var u=t.get(z);
if(typeof u!=="undefined"&&u!==null){x.val(u)
}else{var w=x.val();
if(w){v(z,w)
}}})
};
return n
})(k);
var j=(function(n){var m={};
m.bind=function(o,q,s,r){var p=this;
q.$(o).each(function(y){var v=q.$(this);
var x=r.getBindingValue(v,"select");
var z=function(C,D){v.val(D)
};
var u=function(C,F,E){var D={};
D[C]=F;
D[C+"_text"]=E;
s.set(D)
};
var w=function(C){var F=q.$(C.target);
var D=F.val();
var E=F.find(":selected").text();
u(x,D,E)
};
p.registerModelBinding(s,x,z);
p.registerElementBinding(v,w);
var t=s.get(x);
if(typeof t!=="undefined"&&t!==null){v.val(t)
}if(v.val()!=t){var A=v.val();
var B=v.find(":selected").text();
u(x,A,B)
}})
};
return m
})(k);
var i=(function(n){var m={};
m.bind=function(o,r,t,s){var q=this;
var p=[];
r.$(o).each(function(z){var x=r.$(this);
var w=s.getBindingValue(x,"radio");
if(!p[w]){p[w]=true;
var A=s.getBindingAttr("radio");
var B=function(F,H){var G="input[type=radio]["+A+"='"+w+"'][value='"+H+"']";
r.$(G).attr("checked","checked")
};
q.registerModelBinding(t,w,B);
var v=function(F,H){var G={};
G[F]=H;
t.set(G)
};
var y=function(G){var F=r.$(G.currentTarget);
if(F.is(":checked")){v(w,F.val())
}};
var E="input[type=radio]["+A+"='"+w+"']";
r.$(E).each(function(){var F=h(this);
q.registerElementBinding(F,y)
});
var u=t.get(w);
if(typeof u!=="undefined"&&u!==null){var D="input[type=radio]["+A+"='"+w+"'][value='"+u+"']";
r.$(D).attr("checked","checked")
}else{var D="input[type=radio]["+A+"='"+w+"']:checked";
var C=r.$(D).val();
v(w,C)
}}})
};
return m
})(k);
var f=(function(n){var m={};
m.bind=function(o,q,s,r){var p=this;
q.$(o).each(function(A){var x=q.$(this);
var C=r.getBindingAttr("checkbox");
var B=r.getBindingValue(x,"checkbox");
var z=B.substr(-2)==="[]";
var y=z?B.slice(0,-2):B;
var D=function(E,F){var G=false;
if(z&&F){G=F.indexOf(x.val())>-1
}else{G=F
}if(G){x.attr("checked","checked")
}else{x.removeAttr("checked")
}};
var v=function(G,F){var E={};
E[G]=F;
s.set(E)
};
var w=function(G){var H=q.$(G.target||G);
if(z){var E=h.map(q.$("input:checkbox["+C+"="+y+"\\[\\]]:checked"),function(I){return h(I).val()
});
v(y,E)
}else{var F=H.is(":checked")?true:false;
v(y,F)
}};
p.registerModelBinding(s,y,D);
p.registerElementBinding(x,w);
var u=s.attributes.hasOwnProperty(y);
if(u){var t=s.get(y);
if(typeof t!=="undefined"&&t!==null){D(s,t)
}}else{w(x)
}})
};
return m
})(k);
var g=(function(t,o,s){var n={"default":""};
e.Configuration.dataBindSubst=function(u){this.storeDataBindSubstConfig();
o.extend(n,u)
};
e.Configuration.storeDataBindSubstConfig=function(){e.Configuration._dataBindSubstConfig=o.clone(n)
};
e.Configuration.restoreDataBindSubstConfig=function(){if(e.Configuration._dataBindSubstConfig){n=e.Configuration._dataBindSubstConfig;
delete e.Configuration._dataBindSubstConfig
}};
e.Configuration.getDataBindSubst=function(u,w){var v=w;
if(w===undefined){if(n.hasOwnProperty(u)){v=n[u]
}else{v=n["default"]
}}return v
};
var r=function(v,u,w){w=e.Configuration.getDataBindSubst(u,w);
switch(u){case"html":v.html(w);
break;
case"text":v.text(w);
break;
case"enabled":v.attr("disabled",!w);
break;
case"displayed":v.css("display",w?"block":"none");
break;
case"hidden":v.css("display",w?"none":"block");
break;
default:if(v[0].type!="checkbox"&&v[0].type!="radio"){v.attr(u,w)
}}};
var q=function(w){var x=[];
var v=e.Conventions.databind.selector.replace(/^(.*\[)([^\]]*)(].*)/g,"$2");
var u=w.attr(v).split(";");
o.each(u,function(y){var z=s.trim(y).split(" ");
if(z.length==1){z.unshift("text")
}x.push({elementAttr:z[0],modelAttr:z[1]})
});
return x
};
var p=function(x,y){var w={};
var u=y.modelAttr;
var v=u.indexOf("event:");
if(v==0){w.name=u.substr(6);
w.callback=function(z){r(x,y.elementAttr,z)
}
}else{w.name="change:"+u;
w.callback=function(z,A){r(x,y.elementAttr,A)
}
}return w
};
var m={};
m.bind=function(u,w,y,x){var v=this;
w.$(u).each(function(A){var B=w.$(this);
var z=q(B);
o.each(z,function(D){var C=p(B,D);
v.registerDataBinding(y,C.name,C.callback);
r(B,D.elementAttr,y.get(D.modelAttr))
})
})
};
return m
})(k,l,h);
e.Conventions={text:{selector:"input:text",handler:c},hidden:{selector:"input[type='hidden']",handler:c},textarea:{selector:"textarea",handler:c},password:{selector:"input:password",handler:c},radio:{selector:"input:radio",handler:i},checkbox:{selector:"input:checkbox",handler:f},select:{selector:"select",handler:j},databind:{selector:"*[data-bind]",handler:g},date:{selector:"input[type=date]",handler:c},datetime:{selector:"input[type=datetime]",handler:c},datetime_local:{selector:"input[type=datetime-local]",handler:c},email:{selector:"input[type=email]",handler:c},month:{selector:"input[type=month]",handler:c},number:{selector:"input[type=number]",handler:c},range:{selector:"input[type=range]",handler:c},search:{selector:"input[type=search]",handler:c},tel:{selector:"input[type=tel]",handler:c},time:{selector:"input[type=time]",handler:c},url:{selector:"input[type=url]",handler:c},week:{selector:"input[type=week]",handler:c}};
return e
});
if(typeof define==="function"&&define.amd){define(["backbone","underscore","jquery"],function(e,c,d){return b(e,c,d)
})
}else{a.Backbone=Backbone||{};
a.Backbone.ModelBinding=b(Backbone,_,jQuery)
}})(this);